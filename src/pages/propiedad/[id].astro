---
import { createClient } from '@supabase/supabase-js'
import { publicImageUrl } from '../../lib/imageUrl'

const { id } = Astro.params
const supabase = createClient(
  import.meta.env.PUBLIC_SUPABASE_URL,
  import.meta.env.PUBLIC_SUPABASE_ANON_KEY
)
const { data: p, error } = await supabase
  .from('properties')
  .select('*')
  .eq('id', id)
  .single()
---
<html lang="es">
  <head><meta charset="utf-8" /><title>{p ? p.title : 'Propiedad'}</title></head>
  <body>
	<main class="max-w-3xl mx-auto p-6">
	  {error && <p style="color:red">Error: {error.message}</p>}
	  {p && (
		<>
		  <h1 class="text-2xl font-semibold mb-2">{p.title}</h1>
		  <p class="text-gray-600 mb-4">{p.address}</p>
		  {p.image_path && <img src={publicImageUrl(p.image_path)} alt={p.title} class="rounded mb-6" />}
		  <a class="underline" href="/propiedades">‚Üê Volver</a>
		</>
	  )}
	</main>
  </body>
</html>