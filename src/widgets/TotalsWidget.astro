---
import { fmt, round2 } from "../widgets/propContext";

const { totals, movimientos } = Astro.props;

const total = round2(totals?.total ?? 0);
const pagado = round2(totals?.pagado ?? 0);
const pendiente = round2(totals?.pendiente ?? 0);
const countPaid = totals?.countPaid ?? 0;
const countPend = totals?.countPend ?? 0;
const movCount = movimientos?.length ?? 0;
console.log("Totals en widget:", totals);

---

<section class="widget wg-size grid-3" aria-labelledby="wg-totals-title">
  <h2 id="wg-totals-title" class="widget-title">Resumen económico</h2>
  <div class="widget-row--totals">
	<div class="widget-cell">
	  <span class="data-label label-m">Total</span>
	  <span class="data-money data-xl">{total} €</span>
	  <span class="data-label label-xs">{movCount} movimientos</span>
	</div>
  </div>
  <div class="widget-row wg--2col">
	<div class="widget-cell">
	  <span class="data-money data-m">{pagado} €</span>
	  <span class="data-label label-s">Pagado ({countPaid})</span>
	</div>
	<div class="widget-cell">
	  <span class="data-money data-m">{pendiente} €</span>
	  <span class="data-label label-s">Pendiente ({countPend})</span>
	</div>
  </div>
</section>